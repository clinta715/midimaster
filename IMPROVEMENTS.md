# MIDI Master Improvement Plan

This document outlines a phased plan for improving the quality and musicality of the MIDI output generated by the MIDI Master project. Each phase includes a clear goal and a set of actionable tasks.

## Phase 1: Enhancing Rhythmic Realism and "Groove" (Implemented)

**Goal:** To make the rhythms sound less robotic and more human by introducing timing and velocity variations.

*   **Task 1: Implement Swing/Groove (Implemented)**
    *   **Files Modified:** `output/midi_output.py`, `genres/genre_rules.py`
    *   **Description:** Added `swing_factor` to genre rules and applied swing to off-beat notes in MIDI output.

*   **Task 2: Introduce Micro-timing Imperfections (Implemented)**
    *   **File Modified:** `output/midi_output.py`
    *   **Description:** Added small random timing offsets to notes for humanization.

## Phase 2: Improving Melodic and Harmonic Generation (Implemented)

**Goal:** To create more musically interesting and coherent melodies and harmonies.

*   **Task 1: Implement Melodic Contour Generation (Implemented)**
    *   **File Modified:** `generators/melody_generator.py`
    *   **Description:** Replaced random note selection with a probability-based system favoring melodic contours and smaller intervals.

*   **Task 2: Enhance Chord Progressions and Voice Leading (Implemented)**
    *   **Files Modified:** `genres/genre_rules.py`, `music_theory.py`, `generators/harmony_generator.py`
    *   **Description:** Expanded genre-specific chord progressions, added chord inversion functionality, and applied random inversions in harmony generation.

## Phase 3: Dynamic Song Structure and Transitions (Implemented)

**Goal:** To create more engaging and less predictable song arrangements.

*   **Task 1: Expand Song Section Types (Implemented)**
    *   **File Modified:** `structures/data_structures.py`
    *   **Description:** Added `PRE_CHORUS`, `POST_CHORUS`, `SOLO`, and `FILL` to the `SectionType` enum.

*   **Task 2: Implement Dynamic Structure Generation (Implemented)**
    *   **File Modified:** `structures/song_skeleton.py`
    *   **Description:** Created a method to generate song structures dynamically based on genre and mood.

*   **Task 3: Generate Transitional Fills (Implemented)**
    *   **File Modified:** `generators/pattern_orchestrator.py`
    *   **Description:** Added a method to generate short rhythmic or melodic fill patterns.

## Phase 4: Expressive Performance Details (Implemented)

**Goal:** To add more human-like nuances to the performance.

*   **Task 1: Implement Dynamic Velocity Mapping (Implemented)**
    *   **Files Modified:** `generators/melody_generator.py`, `generators/harmony_generator.py`, `generators/bass_generator.py`, `generators/rhythm_generator.py`
    *   **Description:** Replaced static velocity with a dynamic system influenced by metric position and mood.

*   **Task 2: Add MIDI CC Automation (Implemented)**
    *   **File Modified:** `output/midi_output.py`
    *   **Description:** Added mechanism to generate MIDI Control Change (CC) messages for dynamic expression.

## Phase 5: VST/CLAP Plugin Integration and Audio Rendering (Implemented)

**Goal:** To transform the project from a MIDI generator into a basic audio production tool by integrating VST/CLAP plugin support.

*   **Task 1: Implement Plugin Hosting (Implemented)**
    *   **Files Modified:** `audio/plugin_host.py` (new module)
    *   **Description:** Created a module for loading and managing VST/CLAP plugins.

*   **Task 2: Enumerate Plugin Parameters (Implemented - Code Structure)**
    *   **File Modified:** `audio/plugin_host.py`
    *   **Description:** Added placeholder methods for enumerating plugin parameters (requires external library functionality).

*   **Task 3: Index and Load Presets (Implemented - Code Structure)**
    *   **File Modified:** `audio/plugin_host.py`
    *   **Description:** Added placeholder methods for indexing and loading plugin presets (requires external library functionality).

*   **Task 4: Render MIDI to Audio (Implemented)**
    *   **Files Modified:** `output/audio_output.py` (new file), `main.py`
    *   **Description:** Implemented functionality to render generated MIDI to audio files via a loaded plugin.

## Phase 6: Graphical User Interface (GUI) for Visualization and Interaction (Implemented)

**Goal:** To create a user-friendly graphical interface for controlling the music generation process and visualizing the results.

*   **Task 1: Technology Selection (Implemented - PyQt6)**
    *   **Files Modified:** `gui/main_window.py` (new module)
    *   **Description:** Selected PyQt6 as the GUI framework and set up basic project structure.

*   **Task 2: Implement the Main UI Structure (Implemented)**
    *   **File Modified:** `gui/main_window.py`
    *   **Description:** Designed and implemented the main window with placeholders for controls, piano roll, and playback.

*   **Task 3: Create a Piano Roll Display (Future)**
    *   **File to Modify:** `gui/piano_roll.py` (new file)
    *   **Plan:** Implement a custom widget to render MIDI notes in a zoomable and scrollable piano roll format.

*   **Task 4: Add Parameter Controls (Future)**
    *   **File to Modify:** `gui/main_window.py`
    *   **Plan:** Add UI elements (dropdowns, sliders) to control music generation parameters.

*   **Task 5: Implement Interactive Generation and Playback (Future)**
    *   **Files to Modify:** `gui/main_window.py`, `main.py`
    *   **Plan:** Add a "Generate" button, real-time MIDI display, and playback controls.

*   **Task 6: GUI Matrix of Command-Line Options (New Idea)**
    *   **Files to Modify:** `gui/main_window.py`
    *   **Plan:** Implement a visual matrix or form in the GUI that mirrors all command-line options, allowing users to select parameters and apply them to regenerate the song view.

## Phase 7: Configuration Management (New Idea)

**Goal:** To allow users to save and load combinations of command-line parameters for easy reuse.

*   **Task 1: Implement Parameter Saving**
    *   **Files to Modify:** `main.py`, new module (e.g., `config_manager.py`)
    *   **Plan:** Create functionality to save current command-line parameters to a JSON or INI file.

*   **Task 2: Implement Parameter Loading**
    *   **Files to Modify:** `main.py`, `config_manager.py`
    *   **Plan:** Create functionality to load parameters from a saved configuration file, overriding default command-line arguments.

*   **Task 3: Support Multiple Configurations**
    *   **Files to Modify:** `main.py`, `config_manager.py`
    *   **Plan:** Allow users to specify different configuration files to load, enabling multiple distinct sets of parameters.
